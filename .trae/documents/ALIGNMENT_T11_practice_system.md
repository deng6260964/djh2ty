# T11练习系统需求对齐文档

## 1. 项目上下文分析

### 1.1 现有项目架构
- **技术栈**: Flask 3.0.0 + SQLAlchemy 2.0+ + JWT认证 + CORS支持
- **数据库**: PostgreSQL (通过SQLAlchemy ORM)
- **认证系统**: Flask-JWT-Extended + 会话管理
- **权限控制**: 基于角色的权限系统 (admin/teacher/student)
- **文件管理**: 统一的文件上传和管理系统
- **模块化架构**: 蓝图(Blueprint)模式组织路由

### 1.2 已完成模块分析

#### T05 用户认证系统
- JWT令牌认证和会话管理
- 角色权限控制 (admin/teacher/student)
- 安全中间件和日志系统

#### T06 用户管理系统
- User模型: id, email, name, role, avatar_url, phone, is_active
- 用户CRUD操作和权限验证

#### T07 课程管理系统
- Course模型: 支持一对一和一对多课程类型
- CourseEnrollment模型: 学生选课关系管理
- 课程权限控制和教师-学生关联

#### T08 作业管理系统
- Homework模型: 支持多种作业类型 (writing/reading/listening/speaking/mixed)
- HomeworkSubmission模型: 作业提交、评分、反馈机制
- 状态管理: draft → submitted → graded → returned
- 文件附件支持和逾期检测

#### T09 题库管理系统
- QuestionBank模型: 题库分类、难度、权限管理
- Question模型: 多题型支持 (multiple_choice/true_false/fill_blank/essay/matching)
- 媒体文件支持和答案验证机制

#### T10 考试系统
- Exam模型: 考试配置、时间控制、权限设置
- ExamQuestion模型: 考试题目关联和分值设置
- ExamSubmission模型: 考试提交记录和状态管理
- ExamAnswer模型: 学生答题记录和自动评分

### 1.3 现有设计模式
- **统一的数据模型设计**: 所有模型都包含 id, created_at, updated_at 字段
- **关系映射**: 使用SQLAlchemy关系定义和外键约束
- **状态管理**: 枚举类型定义状态流转
- **权限控制**: @require_auth + @require_permission 装饰器模式
- **数据序列化**: 统一的 to_dict() 方法
- **业务逻辑封装**: 模型内置业务方法 (如submit(), grade()等)

## 2. T11练习系统需求理解

### 2.1 核心功能需求

#### 练习与考试的区别
- **练习目的**: 学习过程导向，注重知识掌握和技能提升
- **考试目的**: 评估导向，注重成绩评定和能力测试
- **时间限制**: 练习通常无严格时间限制，考试有明确时间约束
- **重复性**: 练习可多次进行，考试通常限制次数
- **反馈机制**: 练习提供即时反馈和解析，考试延迟反馈

#### 核心功能模块
1. **练习创建管理**
   - 教师创建练习集
   - 从题库选择题目
   - 设置练习参数 (难度、数量、类型等)
   - 分配给学生或课程

2. **在线练习功能**
   - 学生开始练习
   - 逐题答题界面
   - 即时答案反馈
   - 题目解析显示
   - 进度保存和恢复

3. **学习进度跟踪**
   - 练习完成情况统计
   - 正确率分析
   - 知识点掌握度评估
   - 学习时长记录

4. **智能推荐**
   - 基于错题的重复练习
   - 难度自适应调整
   - 个性化练习推荐

### 2.2 数据模型设计需求

#### Practice (练习集)
- 基本信息: 标题、描述、创建者、课程关联
- 配置参数: 题目数量、难度范围、题型过滤
- 状态管理: 草稿、已发布、已归档
- 权限设置: 可见学生范围

#### PracticeQuestion (练习题目关联)
- 练习与题目的多对多关系
- 题目顺序和分组
- 个性化配置 (提示、解析等)

#### PracticeSession (练习会话)
- 学生练习记录
- 开始时间、结束时间、用时统计
- 完成状态和进度跟踪
- 可暂停和恢复

#### PracticeAnswer (练习答题记录)
- 学生具体答题内容
- 正确性判断
- 答题时长
- 提示使用记录

### 2.3 技术集成方案

#### 与现有系统集成
1. **用户系统集成**: 复用User模型和权限控制
2. **课程系统集成**: 练习可关联到具体课程
3. **题库系统集成**: 直接使用Question和QuestionBank
4. **权限系统集成**: 使用现有的权限常量和装饰器

#### API设计原则
- 遵循RESTful设计规范
- 使用现有的认证和权限中间件
- 统一的错误处理和响应格式
- 支持分页、搜索、过滤功能

## 3. 边界确认

### 3.1 功能边界

#### 包含功能
- 练习集的CRUD管理
- 在线练习功能实现
- 基础的进度跟踪和统计
- 简单的错题重练机制

#### 不包含功能
- 复杂的AI推荐算法
- 高级数据分析和报表
- 实时协作练习
- 语音识别和评测
- 移动端专用功能

### 3.2 技术边界
- 使用现有技术栈，不引入新的主要依赖
- 复用现有的认证、权限、文件管理系统
- 保持与现有模块的一致性
- 不修改现有数据模型结构

### 3.3 时间边界
- 专注于核心功能的MVP实现
- 预留扩展接口但不过度设计
- 确保基础功能的稳定性和可用性

## 4. 疑问澄清

### 4.1 已明确的设计决策

#### 练习模式选择
**决策**: 采用会话式练习模式
**理由**: 支持暂停恢复，更好的用户体验，便于进度跟踪

#### 题目选择策略
**决策**: 教师手动选择 + 系统智能推荐
**理由**: 平衡教学控制和系统智能，符合现有权限模型

#### 反馈机制
**决策**: 即时反馈 + 详细解析
**理由**: 练习的学习导向特性，区别于考试的评估导向

#### 数据存储策略
**决策**: 详细记录所有答题过程
**理由**: 支持学习分析和个性化推荐的数据基础

### 4.2 需要进一步确认的问题

#### 练习重复策略
**问题**: 学生是否可以无限次重复同一练习？
**建议**: 允许重复，但记录每次练习会话，用于进度分析

#### 题目顺序控制
**问题**: 是否支持题目乱序和固定顺序两种模式？
**建议**: 支持两种模式，由教师在创建练习时选择

#### 练习时长限制
**问题**: 是否需要设置练习时长限制？
**建议**: 可选设置，默认无限制，区别于考试的强制时限

## 5. 验收标准

### 5.1 功能验收标准

#### 练习管理功能
- [ ] 教师可以创建、编辑、删除练习集
- [ ] 支持从题库选择题目添加到练习
- [ ] 可以设置练习的基本参数和权限
- [ ] 支持练习的发布和撤回

#### 在线练习功能
- [ ] 学生可以查看分配的练习列表
- [ ] 支持开始、暂停、恢复练习会话
- [ ] 提供逐题答题界面
- [ ] 实现即时答案反馈和解析显示
- [ ] 支持练习进度保存

#### 进度跟踪功能
- [ ] 记录学生练习完成情况
- [ ] 统计正确率和用时
- [ ] 提供基础的学习报告
- [ ] 支持错题查看和重练

### 5.2 技术验收标准

#### 系统集成
- [ ] 与现有用户认证系统无缝集成
- [ ] 正确使用现有权限控制机制
- [ ] 与题库系统正确集成
- [ ] 与课程系统关联正常

#### 代码质量
- [ ] 遵循现有代码规范和模式
- [ ] 完整的单元测试覆盖
- [ ] API文档完整准确
- [ ] 数据库迁移脚本正确

#### 性能要求
- [ ] 练习加载时间 < 2秒
- [ ] 答题响应时间 < 500ms
- [ ] 支持并发用户练习
- [ ] 数据库查询优化

### 5.3 用户体验标准
- [ ] 界面操作直观易用
- [ ] 练习流程顺畅无阻断
- [ ] 错误提示清晰明确
- [ ] 支持常见浏览器兼容

## 6. 风险评估

### 6.1 技术风险
- **数据库性能**: 大量答题记录可能影响查询性能
- **并发处理**: 多用户同时练习的并发控制
- **数据一致性**: 练习会话的状态管理复杂性

### 6.2 业务风险
- **用户体验**: 练习流程的复杂度控制
- **功能边界**: 避免与考试系统功能重叠混淆
- **扩展性**: 为未来功能扩展预留合理接口

### 6.3 风险缓解策略
- 采用分阶段开发，优先核心功能
- 充分复用现有系统组件
- 建立完善的测试覆盖
- 设计清晰的数据模型和API接口